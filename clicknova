// LandingApp.jsx
// Single-file React app (default export LandingApp) with an admin prompt-driven editor.
// Quick start:
// 1) Create a React or Next.js project and install Tailwind CSS.
// 2) Place this file at src/components/LandingApp.jsx and import it into your page.
// 3) Toggle the Admin panel to type natural-language prompts and press Apply.

import React, { useState } from 'react';

const defaultState = {
  brand: 'VT-like',
  heroTitle: 'Create, collect and share â€” faster.',
  heroSubtitle: 'A clean, fast landing page to host links and creative projects.',
  ctaPrimary: 'Start Free',
  ctaSecondary: 'How it works',
  theme: 'indigo',
  links: [
    { id: 1, title: 'Latest: How to launch', url: '#' },
    { id: 2, title: 'Design inspiration', url: '#' },
    { id: 3, title: 'Weekly roundup', url: '#' },
  ],
};

export default function LandingApp(){
  const [state, setState] = useState(defaultState);
  const [adminOpen, setAdminOpen] = useState(false);
  const [prompt, setPrompt] = useState('');
  const [history, setHistory] = useState([]);

  function applyPrompt(p){
    const newState = { ...state };
    let applied = [];

    // Regex-based rules
    const titleMatch = p.match(/(?:set|change|make) (?:the )?hero (?:title|heading) to "([^"]+)"/i);
    if(titleMatch){ newState.heroTitle = titleMatch[1]; applied.push('heroTitle'); }

    const subMatch = p.match(/(?:set|change|make) (?:the )?hero (?:subtitle|subheading) to "([^"]+)"/i);
    if(subMatch){ newState.heroSubtitle = subMatch[1]; applied.push('heroSubtitle'); }

    const brandMatch = p.match(/(?:set|change|brand|rename) (?:brand )?(?:name )?to "([^"]+)"/i);
    if(brandMatch){ newState.brand = brandMatch[1]; applied.push('brand'); }

    const themeMatch = p.match(/(?:use|change|set) theme to (blue|indigo|green|red|purple)/i);
    if(themeMatch){ newState.theme = themeMatch[1]; applied.push('theme'); }

    const addLinkMatch = p.match(/add link "([^"]+)"(?: (?:to|->) )?(https?:\/\/\S+|#)?/i);
    if(addLinkMatch){ newState.links = [{ id: Date.now(), title: addLinkMatch[1], url: addLinkMatch[2] || '#' }, ...newState.links]; applied.push('addLink'); }

    const removeLinkMatch = p.match(/remove link "([^"]+)"/i);
    if(removeLinkMatch){ newState.links = newState.links.filter(l => l.title.toLowerCase() !== removeLinkMatch[1].toLowerCase()); applied.push('removeLink'); }

    const ctaMatch = p.match(/(?:set|change) primary cta to "([^"]+)"/i);
    if(ctaMatch){ newState.ctaPrimary = ctaMatch[1]; applied.push('ctaPrimary'); }

    if(applied.length === 0){
      if(/shorten hero/i.test(p) || /make hero shorter/i.test(p)){
        newState.heroTitle = shortenText(newState.heroTitle); applied.push('shortenHero');
      } else if(/add newsletter/i.test(p)){
        newState.links = [{ id: Date.now(), title: 'Subscribe to newsletter', url: '#subscribe' }, ...newState.links]; applied.push('newsletter');
      }
    }

    setState(newState);
    setHistory([{ prompt: p, applied, before: state, after: newState }, ...history]);
    setPrompt('');
    return applied;
  }

  function shortenText(text){ if(text.length <= 30) return text; return text.split(' ').slice(0,4).join(' ') + '...'; }

  return (
    <div className="min-h-screen bg-gray-50 text-gray-900 antialiased">
      <header className="bg-white shadow-sm">
        <div className="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
          <div className="flex items-center gap-3">
            <div className={`w-10 h-10 rounded-lg bg-gradient-to-br from-${state.theme}-500 to-${state.theme}-700 flex items-center justify-center text-white font-bold`}>{state.brand[0]}</div>
            <span className="font-semibold text-lg">{state.brand}</span>
          </div>
          <div className="flex items-center gap-4">
            <nav className="hidden md:flex gap-6 text-sm">
              <a className="hover:text-indigo-600" href="#features">Features</a>
              <a className="hover:text-indigo-600" href="#pricing">Pricing</a>
              <a className="hover:text-indigo-600" href="#about">About</a>
            </nav>
            <button onClick={()=>setAdminOpen(!adminOpen)} className="px-3 py-2 border rounded-md text-sm">Admin</button>
          </div>
        </div>
      </header>

      <main>
        <section className="max-w-6xl mx-auto px-6 py-16 grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
          <div>
            <h1 className="text-4xl md:text-5xl font-extrabold leading-tight">{state.heroTitle}</h1>
            <p className="mt-6 text-lg text-gray-600">{state.heroSubtitle}</p>

            <div className="mt-8 flex gap-4">
              <a className={`inline-flex items-center gap-2 px-5 py-3 rounded-lg bg-${state.theme}-600 text-white font-medium shadow hover:opacity-95`} href="#">{state.ctaPrimary}</a>
              <a className="inline-flex items-center gap-2 px-5 py-3 rounded-lg border border-gray-200">{state.ctaSecondary}</a>
            </div>

            <div className="mt-6 text-sm text-gray-500">No credit card required â€” cancel anytime.</div>
          </div>

          <div className="relative">
            <div className="rounded-2xl bg-gradient-to-br from-white to-gray-100 p-6 shadow-lg">
              <div className="flex items-center justify-between mb-4">
                <div className="text-xs text-gray-500">Preview</div>
                <div className="text-xs text-gray-400">Live â€¢ English</div>
              </div>

              <div className="bg-white rounded-lg border border-gray-100 p-4">
                <div className="flex items-center gap-3">
                  <div className="w-8 h-8 rounded-md bg-indigo-100 flex items-center justify-center">ðŸ”—</div>
                  <div>
                    <div className="text-sm font-medium">{state.brand} â€” Curated links</div>
                    <div className="text-xs text-gray-400">Aliens, design, and coffee</div>
                  </div>
                </div>

                <ul className="mt-4 space-y-3">
                  {state.links.map(l => (
                    <li key={l.id} className="p-3 rounded-md bg-gray-50 border border-gray-100">
                      <a className="flex justify-between items-center" href={l.url}>{l.title} <span className="text-xs text-gray-400">view</span></a>
                    </li>
                  ))}
                </ul>

                <div className="mt-4 text-center">
                  <a className="inline-block px-4 py-2 rounded-md border border-gray-200 text-sm" href="#">Visit the feed</a>
                </div>
              </div>
            </div>

            <div className="absolute -right-6 -bottom-6 opacity-40 select-none"> 
              <svg width="160" height="120" viewBox="0 0 160 120" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="10" y="10" width="140" height="100" rx="18" fill="#EDE9FE" />
              </svg>
            </div>
          </div>
        </section>

        <section id="features" className="bg-white py-14">
          <div className="max-w-6xl mx-auto px-6">
            <h2 className="text-2xl font-bold">Built for creators and small teams</h2>
            <p className="mt-2 text-gray-600">Fast, simple, and focused on what matters â€” content and conversions.</p>

            <div className="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6">
              <Card title="Instant setup" desc="Publish a landing page in seconds with prebuilt templates." emoji="âš¡" />
              <Card title="Custom domains" desc="Use your own domain and retain full branding." emoji="ðŸ”—" />
              <Card title="Analytics" desc="Simple performance metrics so you can improve." emoji="ðŸ“Š" />
            </div>
          </div>
        </section>

        <section id="get-started" className="bg-indigo-600 text-white py-16">
          <div className="max-w-6xl mx-auto px-6 flex flex-col md:flex-row items-center justify-between gap-6">
            <div>
              <h3 className="text-2xl font-bold">Ready to get started?</h3>
              <p className="mt-2 text-indigo-100">Create your first page and start sharing it on Facebook and anywhere. Fast setup, zero fuss.</p>
            </div>
            <div>
              <a href="#" className="px-6 py-3 bg-white text-indigo-700 rounded-md font-semibold shadow">Create your page</a>
            </div>
          </div>
        </section>

        <footer className="bg-white border-t mt-8">
          <div className="max-w-6xl mx-auto px-6 py-8 flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-gray-600">
            <div>Â© {new Date().getFullYear()} {state.brand}. All rights reserved.</div>
            <div className="flex gap-4">
              <a href="#about">About</a>
              <a href="#privacy">Privacy</a>
              <a href="#terms">Terms</a>
            </div>
          </div>
        </footer>

        {/* Admin panel */}
        <div className={`fixed bottom-6 right-6 w-96 p-4 rounded-lg shadow-lg bg-white border ${adminOpen ? '' : 'opacity-90'}`}>
          <div className="flex items-center justify-between">
            <strong>Admin (prompt)</strong>
            <div className="flex items-center gap-2">
              <button onClick={()=>{ setState(defaultState); setHistory([]); }} className="text-xs px-2 py-1 border rounded">Reset</button>
              <button onClick={()=>setAdminOpen(false)} className="text-xs px-2 py-1 border rounded">Close</button>
            </div>
          </div>

          <textarea value={prompt} onChange={e=>setPrompt(e.target.value)} placeholder={`Try: set hero title to "Simple landing for creators"\nOr: add link "New collection" -> https://example.com\nOr: set theme to green`} className="mt-3 w-full h-24 p-2 border rounded text-sm"></textarea>
          <div className="mt-2 flex gap-2">
            <button onClick={()=>applyPrompt(prompt)} className="px-3 py-2 rounded bg-indigo-600 text-white text-sm">Apply</button>
            <button onClick={()=>{ setPrompt(''); }} className="px-3 py-2 rounded border text-sm">Clear</button>
          </div>

          <details className="mt-3 text-xs text-gray-500">
            <summary>Prompt examples & grammar</summary>
            <ul className="mt-2 list-disc ml-5">
              <li>set hero title to "Your new headline"</li>
              <li>set hero subtitle to "Short supporting line"</li>
              <li>set brand to "MyBrand"</li>
              <li>use theme to green</li>
              <li>add link "Title" -> https://example.com</li>
              <li>remove link "Title"</li>
              <li>shorten hero</li>
              <li>add newsletter</li>
            </ul>
          </details>

          <details className="mt-2 text-xs">
            <summary>Change log</summary>
            <div className="max-h-36 overflow-auto mt-2">
              {history.map((h, i) => (
                <div key={i} className="py-2 border-b text-xs">
                  <div><strong>Prompt:</strong> {h.prompt}</div>
                  <div><strong>Applied:</strong> {h.applied.join(', ') || 'none'}</div>
                </div>
              ))}
            </div>
          </details>
        </div>
      </main>
    </div>
  );
}

function Card({ title, desc, emoji }){
  return (
    <div className="p-6 border border-gray-100 rounded-lg bg-gray-50">
      <div className="text-2xl">{emoji}</div>
      <h4 className="mt-4 font-semibold">{title}</h4>
      <p className="mt-2 text-sm text-gray-600">{desc}</p>
    </div>
  );
}

